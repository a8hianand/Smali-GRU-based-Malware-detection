#!/usr/bin/env python
# coding: utf-8


import os


#removing curly braces
s="{"
s1="}"
s3=","
r=" "

# Specify the root directory (replace 'root_folder' with your actual root folder)
root_folder = 'C:\\Users\\Administrator\\AppData\\Local\\Programs\\Python\\Python311\\Scripts\\LSTM_IndividualSmali\\DB-5'

# Iterate through the root directory and its subfolders
for dirpath, dirnames, filenames in os.walk(root_folder):
    for filename in filenames:
        if filename.endswith('.smali'):  
            path1 = os.path.join(dirpath, filename)
            
            # Now, 'file_path' contains the full path to the text file
            # You can open and preprocess the file here as needed
            with open(path1, 'r',encoding='UTF-8', errors = 'ignore') as file:
                data = file.read()
                data=data.replace(s, r)
                data=data.replace(s1, r)
                data=data.replace(s3, r)
        
            with open(path1, 'w',encoding='UTF-8', errors = 'ignore') as fr:
                fr.write(data) 


# In[7]:


#getting registers
import re

# Initialize a set to store registers
registers = set()

root_folder = 'C:\\Users\\Administrator\\AppData\\Local\\Programs\\Python\\Python311\\Scripts\\LSTM_IndividualSmali\\DB-5'

for dirpath, dirnames, filenames in os.walk(root_folder):
    for filename in filenames:
        if filename.endswith('.smali'):
            path1 = os.path.join(dirpath, filename)

            with open(path1, 'r',encoding='UTF-8', errors = 'ignore') as file:
                data = file.read()  
                temp = data.split()
                for i in temp:
                    if(re.search(r'\b(v|p)\d{1,2}\b', i)):
                        registers.add(i)

# Initialize a set to store filtered registers
r1 = set()

# Filter registers based on length
for i in registers:
    if len(i) <= 3:
        r1.add(i)

# Print the filtered registers
print(r1)


# In[8]:


#removing registers
r=" "
root_folder = 'C:\\Users\\Administrator\\AppData\\Local\\Programs\\Python\\Python311\\Scripts\\LSTM_IndividualSmali\\DB-5'

for dirpath, dirnames, filenames in os.walk(root_folder):
    for filename in filenames:
        if filename.endswith('.smali'):
            path1 = os.path.join(dirpath, filename)

            with open(path1, 'r',encoding='UTF-8', errors = 'ignore') as fr:
                data=fr.read()
                for i in r1:
                    data=data.replace(i, r)
            with open(path1, 'w',encoding='UTF-8', errors = 'ignore') as fr:
                fr.write(data)






